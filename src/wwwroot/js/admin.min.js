function ConvertToValidXHTML(){$("#editor").length&&(parsedDOM=(new DOMParser).parseFromString($("#editor").trumbowyg("html"),"text/html"),parsedDOM=(new XMLSerializer).serializeToString(parsedDOM),/<body>(.*)<\/body>/im.exec(parsedDOM),parsedDOM=RegExp.$1,$("#editor").trumbowyg("html",parsedDOM))}function readURL(n){var i=n.value,t=i.substring(i.lastIndexOf(".")+1).toLowerCase();n.files&&n.files[0]&&(t==="png"||t==="jpeg"||t==="jpg"||t==="gif"||t==="svg")?reader.readAsDataURL(n.files[0]):($("#coverimageupload").val(""),alert("Only Images Are Allowed!"))}function getFaIconFromExt(n){switch(n){case"doc":case"docx":return"fa-file-word";case"pdf":return"fa-file-pdf";case"zip":return"file-archive";case"xls":case"xlsx":return"fa-file-excel";case"txt":return"fa-file-alt";default:return"fa-question"}}var epFileSelectSource,reader,coverimage;if($(".admmenu-item-link").tooltip({placement:function(){return $(window).width()>991?"right":"bottom"}}),epFileSelectSource="",$("#editor").length){$("#editor").trumbowyg({btnsDef:{image:{dropdown:["insertImage","base64"],ico:"insertImage"}},btns:[["viewHTML"],["formatting"],["strong","em","del"],["superscript","subscript"],["link"],["image"],["filepicker"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["horizontalRule"],["removeformat"],["fullscreen"]],imageWidthModalEdit:!1,semantic:!1,autogrow:!1});$("#btnPublish").on("click",function(){return ConvertToValidXHTML(),!0});$("#btnDraft").on("click",function(){return ConvertToValidXHTML(),!0});$("#btnCoverImageUpload").on("click",function(){coverimageupload.click()});$("#btnCoverImageSelect").on("click",function(){$(".fileSelectModalFiles").hide();epFileSelectSource="coverimage"});$("#btnFileSelectCancel").on("click",function(){epFileSelectSource=""});$("#fileSelectModal").on("hidden.bs.modal",function(){epFileSelectSource="";$(".fileSelectModalFiles").show()});$("#fileSelectModal .fileSelectModalImages div, #fileSelectModal .fileSelectModalFiles ul a").on("click",function(){var n=$(this).data("filename"),t=$(this).data("filetype"),i;epFileSelectSource==="coverimage"&&($("#coverimageupload").removeAttr("style"),$("#coverimagepreview").css("background-image","url("+n+")"),$("#coverimageselectbuttons").hide(),$("#coverimageremovebutton").show(),$("#Post_CoverImage").val(n),$("#fileSelectModal").modal("hide"),epFileSelectSource="");epFileSelectSource==="editor"&&(t==="png"||t==="jpeg"||t==="jpg"||t==="gif"||t==="svg"?(i=$("<img>"),i.attr("src",n)):i=$("<span />",{"class":"attachment"}).append($("<a />",{href:n,title:n}).html($("<i />",{"class":"fa "+getFaIconFromExt(t)})).append(" "+n)),$("#editor").trumbowyg("restoreRange"),$("#editor").trumbowyg("execCmd",{cmd:"insertHtml",param:i.prop("outerHTML"),forceCss:!1}),$("#fileSelectModal").modal("hide"),epFileSelectSource="")});reader=new FileReader;reader.onload=function(n){$("#coverimageupload").removeAttr("style");$("#coverimagepreview").css("background-image","url("+n.target.result+")");$("#coverimageselectbuttons").hide();$("#coverimageremovebutton").show()};$("#coverimageupload").change(function(){readURL(this)});$("#coverimageremovebutton a[role=button]").click(function(){$("#coverimageselectbuttons").show();$("#coverimageremovebutton").hide();$("#coverimagepreview").removeAttr("style");$("#coverimageupload").val("");$("#Post_CoverImage").val("")});coverimage=$("#Post_CoverImage").val();coverimage!==""&&($("#coverimageupload").removeAttr("style"),$("#coverimageupload").val(""),$("#coverimagepreview").css("background-image","url("+coverimage+")"),$("#coverimageselectbuttons").hide(),$("#coverimageremovebutton").show())}if($("#filesForm").length){$("#filesForm .card button").on("click",function(){$("#filesForm #SelectedFile").val($(this).attr("data-filepath"))});$("#filesForm #deleteModal button[data-dismiss=modal]").on("click",function(){$("#filesForm #SelectedFile").val("")});$("#filesForm #UploadFile").on("change",function(){var n=$(this).val().replace(/^.*[\\\/]/,"");$(this).next(".custom-file-label").html(n)})}